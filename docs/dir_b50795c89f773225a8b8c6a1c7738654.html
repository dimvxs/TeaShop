<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Shop ProjectMy Project: frontend/node_modules/@parcel/watcher Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Shop ProjectMy Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('dir_b50795c89f773225a8b8c6a1c7738654.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">watcher Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Directory dependency graph for watcher:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" loading="lazy" frameborder="0" src="dir_b50795c89f773225a8b8c6a1c7738654_dep.svg" width="208" height="168"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-subdirs" class="groupheader"><a id="subdirs" name="subdirs"></a>
Directories</h2></td></tr>
<tr class="memitem:src" id="r_src"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_9226bfeebfabc95393ec9435475a7e2c.html">src</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<h1 class="doxsection"><a class="anchor" id="autotoc_md390"></a>
@parcel/watcher</h1>
<p>A native C++ Node module for querying and subscribing to filesystem events. Used by <a href="https://github.com/parcel-bundler/parcel">Parcel 2</a>.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md391"></a>
Features</h1>
<ul>
<li><b>Watch</b> - subscribe to realtime recursive directory change notifications when files or directories are created, updated, or deleted.</li>
<li><b>Query</b> - performantly query for historical change events in a directory, even when your program is not running.</li>
<li><b>Native</b> - implemented in C++ for performance and low-level integration with the operating system.</li>
<li><b>Cross platform</b> - includes backends for macOS, Linux, Windows, FreeBSD, and Watchman.</li>
<li><b>Performant</b> - events are throttled in C++ so the JavaScript thread is not overwhelmed during large filesystem changes (e.g. <span class="tt">git checkout</span> or <span class="tt">npm install</span>).</li>
<li><b>Scalable</b> - tens of thousands of files can be watched or queried at once with good performance.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md392"></a>
Example</h1>
<div class="fragment"><div class="line">const watcher = require(&#39;@parcel/watcher&#39;);</div>
<div class="line">const path = require(&#39;path&#39;);</div>
<div class="line"> </div>
<div class="line">// Subscribe to events</div>
<div class="line">let subscription = await watcher.subscribe(process.cwd(), (err, events) =&gt; {</div>
<div class="line">  console.log(events);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// later on...</div>
<div class="line">await subscription.unsubscribe();</div>
<div class="line"> </div>
<div class="line">// Get events since some saved snapshot in the past</div>
<div class="line">let snapshotPath = path.join(process.cwd(), &#39;snapshot.txt&#39;);</div>
<div class="line">let events = await watcher.getEventsSince(process.cwd(), snapshotPath);</div>
<div class="line"> </div>
<div class="line">// Save a snapshot for later</div>
<div class="line">await watcher.writeSnapshot(process.cwd(), snapshotPath);</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md393"></a>
Watching</h1>
<p><span class="tt">@parcel/watcher</span> supports subscribing to realtime notifications of changes in a directory. It works recursively, so changes in sub-directories will also be emitted.</p>
<p>Events are throttled and coalesced for performance during large changes like <span class="tt">git checkout</span> or <span class="tt">npm install</span>, and a single notification will be emitted with all of the events at the end.</p>
<p>Only one notification will be emitted per file. For example, if a file was both created and updated since the last event, you'll get only a <span class="tt">create</span> event. If a file is both created and deleted, you will not be notifed of that file. Renames cause two events: a <span class="tt">delete</span> for the old name, and a <span class="tt">create</span> for the new name.</p>
<div class="fragment"><div class="line">let subscription = await watcher.subscribe(process.cwd(), (err, events) =&gt; {</div>
<div class="line">  console.log(events);</div>
<div class="line">});</div>
</div><!-- fragment --><p>Events have two properties:</p>
<ul>
<li><span class="tt">type</span> - the event type: <span class="tt">create</span>, <span class="tt">update</span>, or <span class="tt">delete</span>.</li>
<li><span class="tt">path</span> - the absolute path to the file or directory.</li>
</ul>
<p>To unsubscribe from change notifications, call the <span class="tt"><a class="el" href="binding_8cc.html#a9ad8bb9fc246697efe9410ab834fb542">unsubscribe</a></span> method on the returned subscription object.</p>
<div class="fragment"><div class="line">await subscription.unsubscribe();</div>
</div><!-- fragment --><p><span class="tt">@parcel/watcher</span> has the following watcher backends, listed in priority order:</p>
<ul>
<li><a href="https://developer.apple.com/documentation/coreservices/file_system_events">FSEvents</a> on macOS</li>
<li><a href="https://facebook.github.io/watchman/">Watchman</a> if installed</li>
<li><a href="http://man7.org/linux/man-pages/man7/inotify.7.html">inotify</a> on Linux</li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365465%28v%3Dvs.85%29.aspx">ReadDirectoryChangesW</a> on Windows</li>
<li><a href="https://man.freebsd.org/cgi/man.cgi?kqueue">kqueue</a> on FreeBSD, or as an alternative to FSEvents on macOS</li>
</ul>
<p>You can specify the exact backend you wish to use by passing the <span class="tt">backend</span> option. If that backend is not available on the current platform, the default backend will be used instead. See below for the list of backend names that can be passed to the options.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md394"></a>
Querying</h1>
<p><span class="tt">@parcel/watcher</span> also supports querying for historical changes made in a directory, even when your program is not running. This makes it easy to invalidate a cache and re-build only the files that have changed, for example. It can be <b>significantly</b> faster than traversing the entire filesystem to determine what files changed, depending on the platform.</p>
<p>In order to query for historical changes, you first need a previous snapshot to compare to. This can be saved to a file with the <span class="tt"><a class="el" href="binding_8cc.html#a6cc0b70fc62df1a6f8067edcb98ea2e1">writeSnapshot</a></span> function, e.g. just before your program exits.</p>
<div class="fragment"><div class="line">await watcher.writeSnapshot(dirPath, snapshotPath);</div>
</div><!-- fragment --><p>When your program starts up, you can query for changes that have occurred since that snapshot using the <span class="tt"><a class="el" href="binding_8cc.html#a4c13209c94593195cbc219ac01bd6a71">getEventsSince</a></span> function.</p>
<div class="fragment"><div class="line">let events = await watcher.getEventsSince(dirPath, snapshotPath);</div>
</div><!-- fragment --><p>The events returned are exactly the same as the events that would be passed to the <span class="tt"><a class="el" href="binding_8cc.html#ae4051216d69f763625c311af8ecb1aaf">subscribe</a></span> callback (see above).</p>
<p><span class="tt">@parcel/watcher</span> has the following watcher backends, listed in priority order:</p>
<ul>
<li><a href="https://developer.apple.com/documentation/coreservices/file_system_events">FSEvents</a> on macOS</li>
<li><a href="https://facebook.github.io/watchman/">Watchman</a> if installed</li>
<li><a href="http://man7.org/linux/man-pages/man3/fts.3.html">fts</a> (brute force) on Linux and FreeBSD</li>
<li><a href="https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea">FindFirstFile</a> (brute force) on Windows</li>
</ul>
<p>The FSEvents (macOS) and Watchman backends are significantly more performant than the brute force backends used by default on Linux and Windows, for example returning results in miliseconds instead of seconds for large directory trees. This is because a background daemon monitoring filesystem changes on those platforms allows us to query cached data rather than traversing the filesystem manually (brute force).</p>
<p>macOS has good performance with FSEvents by default. For the best performance on other platforms, install <a href="https://facebook.github.io/watchman/">Watchman</a> and it will be used by <span class="tt">@parcel/watcher</span> automatically.</p>
<p>You can specify the exact backend you wish to use by passing the <span class="tt">backend</span> option. If that backend is not available on the current platform, the default backend will be used instead. See below for the list of backend names that can be passed to the options.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md395"></a>
Options</h1>
<p>All of the APIs in <span class="tt">@parcel/watcher</span> support the following options, which are passed as an object as the last function argument.</p>
<ul>
<li><span class="tt">ignore</span> - an array of paths or glob patterns to ignore. uses <a href="https://github.com/micromatch/is-glob"><span class="tt">is-glob</span></a> to distinguish paths from globs. glob patterns are parsed with <a href="https://github.com/micromatch/micromatch"><span class="tt">micromatch</span></a> (see <a href="https://github.com/micromatch/micromatch#matching-features">features</a>).<ul>
<li>paths can be relative or absolute and can either be files or directories. No events will be emitted about these files or directories or their children.</li>
<li>glob patterns match on relative paths from the root that is watched. No events will be emitted for matching paths.</li>
</ul>
</li>
<li><span class="tt">backend</span> - the name of an explicitly chosen backend to use. Allowed options are <span class="tt">"fs-events"</span>, <span class="tt">"watchman"</span>, <span class="tt">"inotify"</span>, <span class="tt">"kqueue"</span>, <span class="tt">"windows"</span>, or <span class="tt">"brute-force"</span> (only for querying). If the specified backend is not available on the current platform, the default backend will be used instead.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md396"></a>
WASM</h1>
<p>The <span class="tt">@parcel/watcher-wasm</span> package can be used in place of <span class="tt">@parcel/watcher</span> on unsupported platforms. It relies on the Node <span class="tt">fs</span> module, so in non-Node environments such as browsers, an <span class="tt">fs</span> polyfill will be needed.</p>
<p><b>Note</b>: the WASM implementation is significantly less efficient than the native implementations because it must crawl the file system to watch each directory individually. Use the native <span class="tt">@parcel/watcher</span> package wherever possible.</p>
<div class="fragment"><div class="line">import {subscribe} from &#39;@parcel/watcher-wasm&#39;;</div>
<div class="line"> </div>
<div class="line">// Use the module as documented above.</div>
<div class="line">subscribe(/* ... */);</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md397"></a>
Who is using this?</h1>
<ul>
<li><a href="https://parceljs.org/">Parcel 2</a></li>
<li><a href="https://code.visualstudio.com/updates/v1_62#_file-watching-changes">VSCode</a></li>
<li><a href="https://github.com/tailwindlabs/tailwindcss-intellisense">Tailwind CSS Intellisense</a></li>
<li><a href="https://twitter.com/chatsidhartha/status/1435647412828196867">Gatsby Cloud</a></li>
<li><a href="https://nx.dev">Nx</a></li>
<li><a href="https://nuxt.com">Nuxt</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md398"></a>
License</h1>
<p>MIT </p>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_ca0386ec887ae6362f93b0d653b52e0c.html">frontend</a></li><li class="navelem"><a href="dir_8be25e30241834509be35899d7f7509b.html">node_modules</a></li><li class="navelem"><a href="dir_f459a06534c547cc106f74476c811709.html">@parcel</a></li><li class="navelem"><a href="dir_b50795c89f773225a8b8c6a1c7738654.html">watcher</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
